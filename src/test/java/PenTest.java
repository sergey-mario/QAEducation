import org.testng.Assert;
import org.testng.annotations.DataProvider;
import org.testng.annotations.Test;

import java.io.ByteArrayOutputStream;
import java.io.PrintStream;

import static org.testng.Assert.*;

public class PenTest {
    @DataProvider(name = "firstPenValues")
    public Object[][] firstPenValues() {
        return new Object[][]{
                {250, "test1", "test1"},
                {0, "test1", ""},
                {-1, "test1", ""},
                {5, "test1", "test1"},
                {4, "test1", "test"}
        };
    }
    @DataProvider(name = "secondPenValue")
    public Object[][] secondPenValue() {
        return new Object[][]{
                {500, 1.0, "test2", "test2"},
                {0, 1.0, "test2", ""},
                {-1, 1.0, "test2", ""},
                {5, 1.0, "test2", "test2"},
                {4, 1.0, "test2", "test"},
                {250, 0, "test2", ""},
                {250, -1.0, "test2", ""},
                {0, 0, "test2", ""},
                {0, -1.0, "test2", ""},
                {-1, 0, "test2", ""},
                {-1, -1.0, "test2", ""},
                {5, 0, "test2", ""},
                {5, -1, "test2", ""},
                {4, 0, "test2", ""},
                {4, -1, "test2", ""},
        };
    }
    @DataProvider(name = "thirdPenValue")
    public Object[][] thirdPenValue() {
        return new Object[][]{
                {500, 1.0, "BLUE", "test2", "test2"},
                {0, 1.0, "BLUE", "test2", ""},
                {-1, 1.0, "BLUE", "test2", ""},
                {5, 1.0, "BLUE", "test2", "test2"},
                {4, 1.0, "BLUE", "test2", "test"},
                {250, 0, "BLUE", "test2", ""},
                {250, -1.0, "BLUE", "test2", ""},
                {0, 0, "BLUE", "test2", ""},
                {0, -1.0, "BLUE", "test2", ""},
                {-1, 0, "BLUE", "test2", ""},
                {-1, -1.0, "BLUE", "test2", ""},
                {5, 0, "BLUE", "test2", ""},
                {5, -1, "BLUE", "test2", ""},
                {4, 0, "BLUE", "test2", ""},
                {4, -1, "BLUE", "test2", ""},
        };
    }
    @DataProvider(name = "typeColor")
    public Object[][] typeColor() {
        return new Object[][]{
                {250, 1.0, "BLUE", "BLUE"},
                {250, 1.0, "red", "BLUE"},
                {250, 1.0, "!!!", "BLUE"},
                {250, 1.0, "red123", "BLUE"},
                {250, 1.0, "123", "BLUE"},
                {250, 1.0, "", "BLUE"},
                {250, 1.0, " ", "BLUE"},
                {250, 1.0, "red!", "BLUE"}
        };
    }
    @DataProvider(name = "firstWorkValues")
    public Object[][] firstWorkValues() {
        return new Object[][]{
                {500, true},
                {0, false},
                {-1, false}
        };
    }
    @DataProvider(name = "secondWorkValues")
    public Object[][] secondWorkValues() {
        return new Object[][]{
                {500, 1.0, true},
                {0, 1.0, false},
                {-1, 1.0, false},
                {250, 0, true},
                {250, -1.0, true},
                {0, 0, false},
                {0, -1.0, false},
                {-1, 0, false},
                {-1, -1.0, false}
        };
    }
    @DataProvider(name = "thirdWorkValues")
    public Object[][] thirdWorkValues() {
        return new Object[][]{
                {500, 1.0, "BLUE", true},
                {0, 1.0, "BLUE", false},
                {-1, 1.0, "BLUE", false},
                {250, 0, "BLUE", true},
                {250, -1.0, "BLUE", true},
                {0, 0, "BLUE", false},
                {0, -1.0, "BLUE", false},
                {-1, 0, "BLUE", false},
                {-1, -1.0, "BLUE", false}
        };
    }
    @DataProvider(name = "valueForDoSmth")
    public Object[][] valueForDoSmth() {
        return new Object[][]{
                {25, "BLUE"},
                {0, "BLUE"},
                {-1, "BLUE"},
        };
    }
    @DataProvider(name = "valueForDoSmthSecondConstructor")
    public Object[][] valueForDoSmthSecondConstructor() {
        return new Object[][]{
                {500, 1.0, "BLUE"},
                {0, 1.0, "BLUE"},
                {-1, 1.0, "BLUE"},
                {250, 0, "BLUE"},
                {250, -1.0, "BLUE"},
                {0, 0, "BLUE"},
                {0, -1.0, "BLUE"},
                {-1, 0, "BLUE"},
                {-1, -1.0, "BLUE"}
        };
    }
    @DataProvider(name = "valueForDoSmthThirdConstructor")
    public Object[][] valueForDoSmthThirdConstructor() {
        return new Object[][]{
                {500, 1.0, "BLUE", "BLUE"},
                {0, 1.0, "BLUE", "BLUE"},
                {-1, 1.0, "BLUE", "BLUE"},
                {250, 0, "BLUE", "BLUE"},
                {250, -1.0, "BLUE", "BLUE"},
                {0, 0, "BLUE", "BLUE"},
                {0, -1.0, "BLUE", "BLUE"},
                {-1, 0, "BLUE", "BLUE"},
                {-1, -1.0, "BLUE", "BLUE"}
        };
    }
    @Test(dataProvider = "firstPenValues")
    public void testWrite(int inkValue, String insertWord, String expectedWord) {
        Pen pen = new Pen(inkValue);
        assertEquals(pen.write(insertWord), expectedWord);
    }
    @Test(dataProvider = "secondPenValue")
    public void testWriteSecondConstructor(int inkValue, double letterSize, String insertWord, String expectedWord) {
        Pen pen = new Pen(inkValue, letterSize);
        assertEquals(pen.write(insertWord), expectedWord);
    }
    @Test(dataProvider = "thirdPenValue")
    public void testWriteThirdConstructor(int inkValue, double letterSize, String color, String insertWord, String expectedWord) {
        Pen pen = new Pen(inkValue, letterSize, color);
        assertEquals(pen.write(insertWord), expectedWord);
    }
    @Test(dataProvider = "typeColor")
    public void testGetColor(int inkValue, double letterSize, String insertColor, String expectedColor) {
        Pen pen = new Pen(inkValue, letterSize, insertColor);
        assertEquals(pen.getColor(), expectedColor);
    }
    @Test(dataProvider = "firstWorkValues")
    public void testIsWork(int inkValue, boolean expectedResult) {
        Pen pen = new Pen(inkValue);
        assertSame(pen.isWork(), expectedResult);
    }
    @Test(dataProvider = "secondWorkValues")
    public void testIsWorkSecondConstructor(int inkValue, double letterSize, boolean expectedResult) {
        Pen pen = new Pen(inkValue, letterSize);
        assertSame(pen.isWork(), expectedResult);
    }
    @Test(dataProvider = "thirdWorkValues")
    public void testIsWorkThirdConstructor(int inkValue, double letterSize, String color, boolean expectedResult) {
        Pen pen = new Pen(inkValue, letterSize, color);
        assertSame(pen.isWork(), expectedResult);
    }
    @Test(dataProvider = "valueForDoSmth")
    public void testDoSomethingElse(int inkValue, String color) {
        Pen pen = new Pen(inkValue);
        final ByteArrayOutputStream outputStream = new ByteArrayOutputStream();
        System.setOut(new PrintStream(outputStream));
        pen.doSomethingElse();
        assertEquals(outputStream.toString().replace("\r\n", ""), color);
    }
    @Test(dataProvider = "valueForDoSmthSecondConstructor")
    public void testDoSomethingElseSecondConstructor(int inkValue, double letterSize, String color) {
        Pen pen = new Pen(inkValue, letterSize);
        final ByteArrayOutputStream outputStream = new ByteArrayOutputStream();
        System.setOut(new PrintStream(outputStream));
        pen.doSomethingElse();
        assertEquals(outputStream.toString().replace("\r\n", ""), color);
    }
    @Test(dataProvider = "valueForDoSmthThirdConstructor")
    public void testDoSomethingElseThirdConstructor(int inkValue, double letterSize, String blueColor, String color) {
        Pen pen = new Pen(inkValue, letterSize, blueColor);
        final ByteArrayOutputStream outputStream = new ByteArrayOutputStream();
        System.setOut(new PrintStream(outputStream));
        pen.doSomethingElse();
        assertEquals(outputStream.toString().replace("\r\n", ""), color);
    }
}
